<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>69 Shades of Love - Self-Care Todo</title>
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/favicon.ico">

    <!-- SEO & Meta Tags -->
    <meta name="description"
        content="Your personal self-care journey with 69 Shades of Love. Track daily self-care tasks and improve your physical, mental, personal, and relationship wellbeing.">
    <meta name="keywords"
        content="self-care, personal development, mental health, physical wellbeing, relationship care, productivity, habit tracker">
    <meta name="author" content="WTQ - What The Quack">
    <meta property="og:title" content="69 Shades of Love - Self-Care Journey">
    <meta property="og:description" content="Your personal self-care journey with 69 tasks to improve your wellbeing.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://tiptopjar.com/proDucktive/preview.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="69 Shades of Love - Self-Care Journey">
    <meta name="twitter:description" content="Track your self-care journey with this beautiful interactive tool.">

    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <!-- Enhanced SPA Routing Script for GitHub Pages -->
    <script type="text/javascript">
        (function() {
            const l = window.location;
            const repoName = '69-shades-of-love'; // GitHub repository name - change if different
            
            // Handle redirect from 404.html with search params that contain encoded path
            if (l.search && l.search[1] === '/') {
                try {
                    // Decode the search params which may contain the original path and query
                    const decoded = l.search.slice(1).split('&').map(function(s) {
                        return s.replace(/~and~/g, '&');
                    }).join('?');
                    
                    // Build the correct path preserving the original route
                    const targetPath = l.pathname.endsWith('/') 
                        ? l.pathname.slice(0, -1) + decoded
                        : l.pathname + decoded;
                    
                    // Replace the current URL with the decoded path
                    window.history.replaceState(null, null, targetPath + l.hash);
                } catch (e) {
                    console.error('Error handling SPA routing:', e);
                }
            }

            // Fix URLs from GitHub Pages format with /?/ to standard SPA format
            if (l.pathname.includes('/?/')) {
                try {
                    const cleanPath = l.pathname.replace('/?/', '/');
                    window.history.replaceState(null, null, cleanPath + l.search + l.hash);
                } catch (e) {
                    console.error('Error cleaning path:', e);
                }
            }
            
            // Handle direct access to SPA routes on GitHub Pages
            // This converts /repo-name/route to /repo-name/#/route
            if (l.pathname.indexOf(repoName) > -1 && !l.hash) {
                const segments = l.pathname.split('/');
                const repoIndex = segments.indexOf(repoName);
                
                // If we have path segments after the repo name and not already using hash routing
                if (repoIndex >= 0 && segments.length > repoIndex + 1 && segments[repoIndex + 1]) {
                    try {
                        // Extract the route after the repo name
                        const route = '/' + segments.slice(repoIndex + 1).join('/');
                        
                        // Construct base path up to repo name
                        const basePath = segments.slice(0, repoIndex + 1).join('/');
                        
                        // Redirect to the hash-based route
                        window.history.replaceState(null, null, 
                            '/' + basePath + '/#' + route + l.search);
                    } catch (e) {
                        console.error('Error handling direct route access:', e);
                    }
                }
            }
        })();
    </script>
</head>

<body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
</body>

</html>